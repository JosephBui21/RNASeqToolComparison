### DESeq2
Data file: data/single625_625/single625_625_5_v1.rds
```{r, echo = TRUE, eval = TRUE, include = TRUE, message = TRUE, error = TRUE, warning = TRUE}
require(DESeq2)
cdata <- readRDS('data/single625_625/single625_625_5_v1.rds')
is.valid <- check_compData(cdata)
if (!(is.valid == TRUE)) stop('Not a valid compData object.')
DESeq2.ds <- DESeq2::DESeqDataSetFromMatrix(countData = count.matrix(cdata), colData = data.frame(condition = factor(sample.annotations(cdata)$condition)), design = ~ condition)
DESeq2.ds <- DESeq2::DESeq(DESeq2.ds, fitType = 'parametric', test = 'Wald', betaPrior = TRUE)
DESeq2.ds.clean <- DESeq2::replaceOutliersWithTrimmedMean(DESeq2.ds)
DESeq2.ds.clean <- DESeq2::DESeq(DESeq2.ds.clean, fitType = 'parametric', test = 'Wald', betaPrior = TRUE)
DESeq2.ds <- DESeq2.ds.clean
DESeq2.results <- DESeq2::results(DESeq2.ds, independentFiltering = TRUE, cooksCutoff = TRUE)
DESeq2.pvalues <- DESeq2.results$pvalue
DESeq2.adjpvalues <- DESeq2.results$padj
DESeq2.logFC <- DESeq2.results$log2FoldChange
DESeq2.score <- 1 - DESeq2.pvalues
result.table <- data.frame('pvalue' = DESeq2.pvalues, 'adjpvalue' = DESeq2.adjpvalues, 'logFC' = DESeq2.logFC, 'score' = DESeq2.score)
rownames(result.table) <- rownames(count.matrix(cdata))
result.table(cdata) <- result.table
package.version(cdata) <- paste('DESeq2,', packageVersion('DESeq2'))
analysis.date(cdata) <- date()
method.names(cdata) <- list('short.name' = 'DESeq2', 'full.name' = 'DESeq2.1.26.0.parametric.Wald.bp.indf.cook_TRUE.imp')
is.valid <- check_compData_results(cdata)
if (!(is.valid == TRUE)) stop('Not a valid compData result object.')
saveRDS(cdata, '/home/job017/RNASeqToolComparison/out/DESeq2/single625_625_5/single625_625_5_v1_DESeq2.rds')
print(paste('Unique data set ID:', info.parameters(cdata)$uID))
sessionInfo()
```
